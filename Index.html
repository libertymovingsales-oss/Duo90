<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Duo90 â€” Derrick & Kimaada</title>
<meta name="theme-color" content="#1473e6"/>
<link rel="manifest" href='data:application/manifest+json,{"name":"Duo90%20%E2%80%93%2090-Day%20Plan%20(Derrick%20%26%20Kimaada)","short_name":"Duo90","start_url":"./index.html","display":"standalone","background_color":"#0b1220","theme_color":"#1473e6","icons":[{"src":"https://placehold.co/192x192/png?text=D90","sizes":"192x192","type":"image/png"},{"src":"https://placehold.co/512x512/png?text=D90","sizes":"512x512","type":"image/png"}]}'>
<link rel="icon" href="https://placehold.co/192x192/png?text=D90" sizes="192x192">
<style>
:root{--bg:#0b1220;--card:#101a33;--accent:#1473e6;--muted:#8ea6c9;--text:#eaf2ff}
*{box-sizing:border-box}html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.wrap{max-width:980px;margin:0 auto;padding:16px}
header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(16,26,51,.95),rgba(16,26,51,.85));border-bottom:1px solid #1d2a4d}
h1{font-size:21px;margin:8px 0}
.tabs{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 4px}
.tabs button{background:transparent;color:var(--muted);border:1px solid #1e2b50;padding:8px 12px;border-radius:999px}
.tabs button.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.grid{display:grid;gap:14px}.two{grid-template-columns:1fr}@media(min-width:900px){.two{grid-template-columns:1fr 1fr}}
.card{background:var(--card);border:1px solid #1d2a4d;border-radius:16px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,.25)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
input,textarea,select{width:100%;padding:10px 12px;background:#0f1830;color:var(--text);border:1px solid #283a6d;border-radius:12px}
textarea{min-height:72px;resize:vertical}
.btn{border:0;background:var(--accent);color:#fff;padding:10px 14px;border-radius:12px;font-weight:600}
.btn.ghost{background:transparent;border:1px solid #2a3d72}
.small{color:var(--muted);font-size:12px}
.checklist label{display:flex;align-items:center;gap:10px;padding:8px 10px;border:1px solid #223466;border-radius:12px;margin-bottom:8px}
.weeknav{display:flex;gap:8px;flex-wrap:wrap}
.weeknav button{padding:6px 10px;border-radius:10px;border:1px solid #273968;background:#0f1830;color:var(--muted)}
.weeknav button.active{background:#18306b;color:#fff;border-color:#2e4ba0}
.photo-grid{display:grid;gap:10px;grid-template-columns:1fr 1fr 1fr}
.photo{border:1px dashed #2b3f75;border-radius:12px;padding:10px;text-align:center}
.photo img{max-width:100%;border-radius:10px}
.tag{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid #2a3d72}
footer{padding:26px 0;text-align:center;color:var(--muted);font-size:12px}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>ðŸ’™ Duo90 â€” Derek & Heavenâ€™s Reflection</h1>
    <nav class="tabs">
      <button class="active" data-tab="dash">Dashboard</button>
      <button data-tab="weeks">Weeks</button>
      <button data-tab="photos">Photos</button>
      <button data-tab="metrics">Metrics</button>
      <button data-tab="about">About</button>
    </nav>
  </div>
</header>

<main class="wrap">
  <!-- DASH -->
  <section id="dash" class="tab">
    <div class="grid two">
      <div class="card">
        <h3>Today â€” Heavenâ€™s Reflection</h3>
        <div id="her-list" class="checklist"></div>
        <label>Notes<textarea id="her-notes" placeholder="How did you feel today?"></textarea></label>
      </div>
      <div class="card">
        <h3>Today â€” Derek</h3>
        <div id="his-list" class="checklist"></div>
        <label>Notes<textarea id="his-notes" placeholder="Energy, focus, wins..."></textarea></label>
      </div>
    </div>
    <div class="card" style="margin-top:10px">
      <div class="row">
        <div>
          <label>Start Date<input id="start-date" type="date"/></label>
          <label>Day # (1â€“90)<input id="day-num" type="number" min="1" max="90"/></label>
          <div class="small">Set your 90-day start; the app auto-picks today.</div>
        </div>
        <button id="jump-today" class="btn">Jump to Today</button>
      </div>
    </div>
  </section>

  <!-- WEEKS -->
  <section id="weeks" class="tab" style="display:none">
    <div class="card">
      <div class="row">
        <div class="weeknav" id="weeknav"></div>
        <button id="apply-w1" class="btn">Apply Week-1 Template</button>
      </div>
    </div>
    <div id="week-grid" class="grid two" style="margin-top:10px"></div>
  </section>

  <!-- PHOTOS -->
  <section id="photos" class="tab" style="display:none">
    <div class="card">
      <h3>Weekly Progress Photos</h3>
      <div class="row">
        <label>Week<select id="photo-week"></select></label>
        <span class="tag">Front / Side / Back</span>
      </div>
    </div>
    <div class="grid two" style="margin-top:10px">
      <div class="card">
        <h3>Heavenâ€™s Reflection</h3>
        <div class="photo-grid">
          <div class="photo"><label>Front<input type="file" accept="image/*" capture="environment" id="her-front"></label><div id="her-front-p"></div></div>
          <div class="photo"><label>Side<input type="file" accept="image/*" capture="environment" id="her-side"></label><div id="her-side-p"></div></div>
          <div class="photo"><label>Back<input type="file" accept="image/*" capture="environment" id="her-back"></label><div id="her-back-p"></div></div>
        </div>
      </div>
      <div class="card">
        <h3>Derek</h3>
        <div class="photo-grid">
          <div class="photo"><label>Front<input type="file" accept="image/*" capture="environment" id="his-front"></label><div id="his-front-p"></div></div>
          <div class="photo"><label>Side<input type="file" accept="image/*" capture="environment" id="his-side"></label><div id="his-side-p"></div></div>
          <div class="photo"><label>Back<input type="file" accept="image/*" capture="environment" id="his-back"></label><div id="his-back-p"></div></div>
        </div>
      </div>
    </div>
  </section>

  <!-- METRICS -->
  <section id="metrics" class="tab" style="display:none">
    <div class="grid two">
      <div class="card">
        <h3>Measurements â€” Heavenâ€™s Reflection</h3>
        <div class="row">
          <label>Weight (lb)<input id="her-w" type="number" step="0.1"></label>
          <label>Waist (in)<input id="her-wa" type="number" step="0.1"></label>
          <label>Hips (in)<input id="her-hi" type="number" step="0.1"></label>
        </div>
        <div class="row">
          <label>Energy (1â€“5)<input id="her-en" type="number" min="1" max="5"></label>
          <label>Mood (1â€“5)<input id="her-mo" type="number" min="1" max="5"></label>
        </div>
        <button id="save-her" class="btn">Save</button>
      </div>
      <div class="card">
        <h3>Measurements â€” Derek</h3>
        <div class="row">
          <label>Weight (lb)<input id="his-w" type="number" step="0.1"></label>
          <label>Waist (in)<input id="his-wa" type="number" step="0.1"></label>
          <label>Chest (in)<input id="his-ch" type="number" step="0.1"></label>
        </div>
        <div class="row">
          <label>Energy (1â€“5)<input id="his-en" type="number" min="1" max="5"></label>
          <label>Focus (1â€“5)<input id="his-fo" type="number" min="1" max="5"></label>
        </div>
        <button id="save-his" class="btn">Save</button>
      </div>
    </div>
    <div class="card" style="margin-top:10px">
      <h3>Export / Import</h3>
      <div class="row">
        <button id="export" class="btn">Export JSON</button>
        <input type="file" id="import" accept="application/json">
        <button id="reset" class="btn ghost">Reset All</button>
      </div>
      <div class="small">Export makes a .json you can share. Import replaces current data.</div>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="about" class="tab" style="display:none">
    <div class="card">
      <h3>About Duo90</h3>
      <p>Private, offline-friendly 90-day planner for two. Local storage. Optional install to Home Screen. To enable offline caching, keep the tiny <code>sw.js</code> file in the repo.</p>
    </div>
  </section>
</main>
<footer>Made with love for Derek & Heavenâ€™s Reflection â€¢ Duo90 v1.0</footer>

<script>
const $=s=>document.querySelector(s), $$=s=>[...document.querySelectorAll(s)];
// tabs
$$('.tabs button').forEach(b=>b.onclick=()=>{$$('.tabs button').forEach(x=>x.classList.remove('active'));$$('main .tab').forEach(t=>t.style.display='none');b.classList.add('active');document.getElementById(b.dataset.tab).style.display='block'; if(b.dataset.tab==='weeks') drawWeek(); if(b.dataset.tab==='photos') renderPhotos();});
// state
const emptyDay=()=>({her:{tasks:[],done:{},notes:""},his:{tasks:[],done:{},notes:""}});
const def={start:null,days:Array.from({length:90},emptyDay),photos:{},metrics:{her:{},his:{}}};
let st=load(); function load(){try{const r=localStorage.getItem('duo90');return r?Object.assign(structuredClone(def),JSON.parse(r)):structuredClone(def);}catch{return structuredClone(def)}}
const save=()=>localStorage.setItem('duo90',JSON.stringify(st));
const iso=()=>new Date().toISOString().slice(0,10);
const idxFromDate=d=>{if(!st.start)return 0;const a=new Date(st.start+"T00:00:00"),b=new Date(d+"T00:00:00");return Math.min(89,Math.max(0,Math.floor((b-a)/86400000)));};
const dateFromIdx=i=>{ if(!st.start){const t=new Date();t.setHours(0,0,0,0);return t.toISOString().slice(0,10);} const a=new Date(st.start+"T00:00:00"); const d=new Date(a.getTime()+i*86400000); return d.toISOString().slice(0,10); };
let active=st.start?idxFromDate(iso()):0;
// dashboard
const herList=$("#her-list"),hisList=$("#his-list"),herNotes=$("#her-notes"),hisNotes=$("#his-notes"),dayNum=$("#day-num"),startDate=$("#start-date");
function renderDash(){
  dayNum.value=active+1; startDate.value=st.start||"";
  const d=st.days[active];
  const draw=(root,role)=>{
    root.innerHTML=""; const e=d[role];
    if(e.tasks.length===0){ e.tasks= role==='her'?["30m walking","20m belly dance","Evening stretch & journal"]:["20m walk","Light weights (upper)","Evening breathwork"]; e.done={}; save(); }
    e.tasks.forEach((t,i)=>{const L=document.createElement('label');L.innerHTML=`<input type="checkbox"> <span>${t}</span>`;const cb=L.querySelector('input');cb.checked=!!e.done[i];cb.onchange=()=>{e.done[i]=cb.checked;save();};root.appendChild(L);});
    const row=document.createElement('div'); row.className='row';
    row.innerHTML=`<input type="text" placeholder="Add a task"><button class="btn">+</button><button class="btn ghost">Clear</button>`;
    const inp=row.querySelector('input'),add=row.querySelectorAll('button')[0],clr=row.querySelectorAll('button')[1];
    add.onclick=()=>{if(!inp.value.trim())return;e.tasks.push(inp.value.trim());inp.value="";e.done={};save();renderDash();};
    clr.onclick=()=>{e.done={};save();renderDash();};
    root.appendChild(row);
  };
  draw(herList,'her'); draw(hisList,'his');
  herNotes.value=d.her.notes||""; hisNotes.value=d.his.notes||"";
}
herNotes.oninput=()=>{st.days[active].her.notes=herNotes.value;save();};
hisNotes.oninput=()=>{st.days[active].his.notes=hisNotes.value;save();};
$("#jump-today").onclick=()=>{active=st.start?idxFromDate(iso()):0;renderDash();}
dayNum.onchange=()=>{const v=Math.min(90,Math.max(1,Number(dayNum.value||1)));active=v-1;renderDash();};
startDate.onchange=()=>{st.start=startDate.value||null;save();};
// weeks
const weeknav=$("#weeknav"),weekGrid=$("#week-grid");
function drawWeek(){
  weeknav.innerHTML=""; for(let w=0;w<13;w++){const b=document.createElement('button');b.textContent=`Week ${w+1}`; if(Math.floor(active/7)===w)b.classList.add('active'); b.onclick=()=>{ [...weeknav.children].forEach(x=>x.classList.remove('active')); b.classList.add('active'); drawWeekGrid(w); }; weeknav.appendChild(b);}
  drawWeekGrid(Math.floor(active/7));
}
function drawWeekGrid(w){
  weekGrid.innerHTML=""; for(let d=0;d<7;d++){const i=w*7+d; if(i>89)break; const day=st.days[i],dt=dateFromIdx(i);
    const card=document.createElement('div'); card.className='card';
    card.innerHTML=`<div class="row" style="justify-content:space-between"><h4>Day ${i+1}</h4><span class="tag">${dt}</span></div>
    <div class="grid two"><div><label>Her Tasks (comma separated)</label><input data-role="her" data-idx="${i}" value="${(day.her.tasks||[]).join(', ')}"></div>
    <div><label>His Tasks (comma separated)</label><input data-role="his" data-idx="${i}" value="${(day.his.tasks||[]).join(', ')}"></div></div>`;
    weekGrid.appendChild(card);
  }
  weekGrid.querySelectorAll('input').forEach(inp=>{inp.onchange=()=>{const i=+inp.dataset.idx,r=inp.dataset.role; st.days[i][r].tasks=inp.value.split(',').map(s=>s.trim()).filter(Boolean); st.days[i][r].done={}; save(); if(i===active)renderDash();};});
}
$("#apply-w1").onclick=()=>{const wk=[
  {her:["30m walking","20m belly dance","Evening stretch & journal"],his:["15m vibration plate","20m walk","Light weights (upper)"]},
  {her:["15m Pilates","15m trampoline","10m side stretch"],his:["20m walk","Pushups x3 sets","Light dumbbells"]},
  {her:["30m bachata","20m belly dance","Gratitude journal"],his:["20m walk","20m vibration plate","Core circuit"]},
  {her:["30m walking","15m Pilates core","Scripture/affirmation"],his:["25m walk","Weights (legs)","Evening stretch"]},
  {her:["40m belly dance/flow","Skincare ritual"],his:["20m walk","Full-body light weights","Progress notes"]},
  {her:["30â€“40m outdoor walk","Light Pilates","Spa-style self-care"],his:["30m cardio","Bodyweight squats","Foam roll"]},
  {her:["Rest/gentle walk","Photos + measurements"],his:["Rest/light walk","Photos + measurements"]}
]; for(let d=0;d<7;d++){st.days[d].her.tasks=wk[d].her; st.days[d].his.tasks=wk[d].his; st.days[d].her.done={}; st.days[d].his.done={};} save(); drawWeek(); renderDash(); alert("Week-1 loaded.");};
// photos
const photoWeek=$("#photo-week");
function ensureWeek(w){ if(!st.photos[w]) st.photos[w]={her:{},his:{}}; return st.photos[w]; }
function setPrev(id,data){ const el=document.getElementById(id+'-p'); el.innerHTML = data?`<img src="${data}" alt="preview">`:`<div class="small">No photo</div>`; }
function renderPhotos(){ photoWeek.innerHTML=""; for(let w=0;w<13;w++){const o=document.createElement('option');o.value=w;o.textContent=`Week ${w+1}`; if(Math.floor(active/7)===w)o.selected=true; photoWeek.appendChild(o);} loadPrevs(+photoWeek.value);}
photoWeek&& (photoWeek.onchange=()=>loadPrevs(+photoWeek.value));
async function fileToData(file,max=1200){ const img=await new Promise((res,rej)=>{const fr=new FileReader(); fr.onload=()=>{const i=new Image(); i.onload=()=>res(i); i.onerror=rej; i.src=fr.result; }; fr.onerror=rej; fr.readAsDataURL(file);}); const c=document.createElement('canvas'),x=c.getContext('2d'); const r=Math.min(1,max/Math.max(img.width,img.height)); c.width=Math.round(img.width*r); c.height=Math.round(img.height*r); x.drawImage(img,0,0,c.width,c.height); return c.toDataURL('image/jpeg',0.8); }
function bindPhoto(inputId,role,part){ const inp=document.getElementById(inputId); if(!inp)return; inp.onchange=async e=>{const w=+photoWeek.value,p=ensureWeek(w); const f=e.target.files?.[0]; if(!f)return; p[role][part]=await fileToData(f,1200); save(); loadPrevs(w);};}
function loadPrevs(w){ const p=ensureWeek(w); setPrev('her-front',p.her.front); setPrev('her-side',p.her.side); setPrev('her-back',p.her.back); setPrev('his-front',p.his.front); setPrev('his-side',p.his.side); setPrev('his-back',p.his.back);}
bindPhoto('her-front','her','front'); bindPhoto('her-side','her','side'); bindPhoto('her-back','her','back');
bindPhoto('his-front','his','front'); bindPhoto('his-side','his','side'); bindPhoto('his-back','his','back');
// metrics
function saveMetrics(role){ const k=dateFromIdx(active); if(!st.metrics[role]) st.metrics[role]={}; const o={};
if(role==='her'){ o.weight=$("#her-w").value||null; o.waist=$("#her-wa").value||null; o.hips=$("#her-hi").value||null; o.energy=$("#her-en").value||null; o.mood=$("#her-mo").value||null; }
else{ o.weight=$("#his-w").value||null; o.waist=$("#his-wa").value||null; o.chest=$("#his-ch").value||null; o.energy=$("#his-en").value||null; o.focus=$("#his-fo").value||null; }
st.metrics[role][k]=o; save(); alert("Saved.");}
$("#save-her").onclick=()=>saveMetrics('her'); $("#save-his").onclick=()=>saveMetrics('his');
$("#export").onclick=()=>{ const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([JSON.stringify(st)],{type:'application/json'})); a.download='duo90-export.json'; a.click(); };
$("#import").onchange=async e=>{const f=e.target.files?.[0]; if(!f)return; try{const t=await f.text(); st=Object.assign(structuredClone(def),JSON.parse(t)); save(); renderDash(); drawWeek(); renderPhotos(); alert("Import complete.");}catch{alert("Import failed.");}};
$("#reset").onclick=()=>{if(confirm("Erase all Duo90 data on this device?")){localStorage.removeItem('duo90'); st=structuredClone(def); renderDash(); drawWeek(); renderPhotos(); alert("Cleared.");}};
// init + SW
function init(){ $("#start-date").value=st.start||""; active=st.start?idxFromDate(iso()):0; renderDash(); drawWeek(); if('serviceWorker'in navigator) navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
init();
</script>
</body>
  </html>
